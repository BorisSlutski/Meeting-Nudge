<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self'; script-src 'self'; img-src 'self' data:;">
  <title>Meeting Nudge - Settings</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <div style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 8px;">
        <img src="../assets/owl-icon.png" alt="Owl Icon" style="width: 64px; height: 64px;">
        <h1 style="margin: 0;">Meeting Nudge</h1>
      </div>
      <p class="subtitle">Never miss a meeting again</p>
    </header>

    <main>
      <!-- Calendar Connections -->
      <section class="card">
        <h2>Calendar Connections</h2>
        
        <div class="connection-item">
          <div class="connection-info">
            <span class="connection-icon">G</span>
            <div>
              <strong>Google Calendar</strong>
              <p class="connection-status" id="google-status">Not connected</p>
            </div>
          </div>
          <button class="btn" id="google-btn">Connect</button>
        </div>
        
        <button class="btn btn-secondary sync-button" id="sync-btn">
          Sync Now
        </button>
        <p class="sync-status" id="sync-status" style="margin-top: 12px; font-size: 14px; color: #888;">
          Not synced yet
        </p>
      </section>

      <!-- Upcoming Meetings -->
      <section class="card">
        <h2>Upcoming Meetings</h2>
        <div id="upcoming-events" class="events-list">
          <p class="empty-state">No upcoming meetings</p>
        </div>
      </section>

      <!-- Pause Status -->
      <section class="card" id="pause-status-card" style="display: none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h2 style="color: white; margin-bottom: 8px;">‚è∏Ô∏è Reminders Paused</h2>
            <p id="pause-status-text" style="margin: 0; opacity: 0.9;">Paused</p>
          </div>
          <button class="btn" id="resume-btn" style="background: white; color: #667eea; border: none;">Resume Now</button>
        </div>
      </section>

      <!-- Calendar Selection -->
      <section class="card collapsible" id="calendar-section">
        <h2 class="collapsible-header">
          üìÖ Calendar Selection
          <span class="toggle-icon">‚ñº</span>
        </h2>
        <div class="collapsible-content">
          <p class="setting-note">
            Choose which Google calendars to monitor for meetings. Select multiple calendars to get reminders from all of them.
          </p>

          <div class="setting-actions">
            <button class="btn btn-secondary" id="refresh-calendars-btn">
              Refresh Calendars
            </button>
          </div>

          <div id="calendars-list" style="margin-top: 16px;">
            <!-- Calendars will be loaded here -->
          </div>

          <span class="inline-status" id="calendar-status"></span>
        </div>
      </section>

      <!-- Reminder Settings -->
      <section class="card">
        <h2>Reminder Settings</h2>
        
        <div class="setting-item">
          <label>Remind me before meetings:</label>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="remind-10" checked>
              <span>10 minutes</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="remind-5" checked>
              <span>5 minutes</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="remind-1" checked>
              <span>1 minute</span>
            </label>
          </div>
        </div>

        <div class="setting-item">
          <label for="sync-interval">Sync interval:</label>
          <select id="sync-interval">
            <option value="1">Every 1 minute</option>
            <option value="5">Every 5 minutes</option>
            <option value="10">Every 10 minutes</option>
            <option value="15">Every 15 minutes</option>
            <option value="30">Every 30 minutes</option>
          </select>
        </div>

        <div class="setting-item">
          <label class="checkbox-label">
            <input type="checkbox" id="sound-enabled" checked>
            <span>Play alert sound</span>
          </label>
        </div>

        <div class="setting-item" id="sound-options" style="margin-left: 28px;">
          <label for="sound-file">Alert sound:</label>
          <select id="sound-file">
            <option value="default.mp3">Default Alert</option>
            <option value="gentle.mp3">Gentle Chime</option>
            <option value="urgent.mp3">Urgent Bell</option>
            <option value="digital.mp3">Digital Beep</option>
            <option value="custom.mp3">Custom Sound</option>
          </select>
        </div>

        <div class="setting-item" id="volume-control" style="margin-left: 28px;">
          <label for="sound-volume">Volume: <span id="volume-value">70</span>%</label>
          <input type="range" id="sound-volume" min="0" max="100" value="70" style="width: 100%; max-width: 300px;">
        </div>

        <div class="setting-item">
          <label class="checkbox-label">
            <input type="checkbox" id="preview-notifications-enabled" checked>
            <span>Show preview notification (30s before full-screen)</span>
          </label>
          <p class="setting-note" style="margin-top: 4px; font-size: 13px;">
            A gentle notification appears before the full-screen alert
          </p>
        </div>
      </section>

      <!-- Test Mode -->
      <section class="card collapsible collapsed" id="test-section" style="border: 2px solid #ff9800;">
        <h2 id="test-header" class="collapsible-header">
          üß™ Test & Debug
          <span class="toggle-icon">‚ñº</span>
        </h2>
        <div class="collapsible-content">
          <h3 style="margin-top: 0;">Test Mode</h3>
          <p class="setting-note">
            Generate test meetings for development and demo purposes. No real calendar connection needed.
          </p>
          <div class="setting-actions">
            <button class="btn" id="generate-test-btn">Generate Test Events</button>
            <button class="btn" id="test-reminder-btn" style="background: #ff5722;">Test Reminder Now</button>
          </div>
          <span class="inline-status" id="test-status" aria-live="polite"></span>
          
          <h3 style="margin-top: 24px;">Logs & Debugging</h3>
          <p class="setting-note">
            Access application logs for troubleshooting. Logs are stored locally and rotated automatically (max 5MB).
          </p>
          <div class="setting-actions">
            <button class="btn" id="open-log-btn" style="background: #607d8b;">Open Log File</button>
          </div>
          <span class="inline-status" id="log-path-text" style="font-size: 12px; color: #888;"></span>
        </div>
      </section>

      <!-- Appearance -->
      <section class="card">
        <h2>üé® Appearance</h2>
        
        <div class="setting-item">
          <label>Theme:</label>
          <div class="theme-selector">
            <button class="theme-option" data-theme="light">
              <span class="theme-icon">‚òÄÔ∏è</span>
              <span>Light</span>
            </button>
            <button class="theme-option" data-theme="dark">
              <span class="theme-icon">üåô</span>
              <span>Dark</span>
            </button>
            <button class="theme-option active" data-theme="system">
              <span class="theme-icon">üíª</span>
              <span>System</span>
            </button>
          </div>
        </div>
      </section>

      <!-- Google OAuth Credentials -->
      <section class="card collapsible collapsed" id="oauth-section">
        <h2 id="oauth-header" class="collapsible-header">
          Google OAuth Credentials
          <span class="credentials-status" id="credentials-badge"></span>
          <span class="toggle-icon">‚ñº</span>
        </h2>
        <div class="collapsible-content">
          <p class="setting-note">
            Set these once to enable Google Calendar. Stored securely in your OS keychain.
          </p>
          <div class="setting-item">
            <label for="google-client-id">Client ID</label>
            <input type="text" id="google-client-id" placeholder="YOUR_CLIENT_ID">
          </div>
          <div class="setting-item">
            <label for="google-client-secret">Client Secret</label>
            <input type="password" id="google-client-secret" placeholder="YOUR_CLIENT_SECRET">
          </div>
          <div class="setting-actions">
            <button class="btn" id="oauth-save-btn">Save Credentials</button>
            <span class="inline-status" id="oauth-status" aria-live="polite"></span>
          </div>
        </div>
      </section>

      <!-- OAuth Setup Instructions -->
      <section class="card collapsible collapsed" id="setup-section">
        <h2 id="setup-header" class="collapsible-header">
          Setup Instructions
          <span class="toggle-icon">‚ñº</span>
        </h2>
        <div class="collapsible-content">
          <div class="instructions">
            <h3>Google Calendar Setup</h3>
            <ol>
              <li>Go to <a href="#" class="external-link" data-url="https://console.cloud.google.com">Google Cloud Console</a></li>
              <li>Create a new project (or select existing)</li>
              <li>Enable the Google Calendar API</li>
              <li>Complete the OAuth consent screen (APIs &amp; Services)</li>
              <li>Create OAuth 2.0 credentials (Desktop app)</li>
              <li>Copy the Client ID and Client Secret from the credentials page</li>
              <li>Set environment variables:
                <code>GOOGLE_CLIENT_ID</code> and <code>GOOGLE_CLIENT_SECRET</code>
              </li>
            </ol>

            <h3>Where to get your Google keys</h3>
            <ol>
              <li>In Google Cloud Console, open <strong>APIs &amp; Services</strong> ‚Üí <strong>Credentials</strong></li>
              <li>Select your OAuth client (Desktop app) to view the <strong>Client ID</strong> and <strong>Client Secret</strong></li>
              <li>Alternatively, click <strong>Download JSON</strong> and copy the values from the file</li>
              <li>Make sure the OAuth consent screen is configured for your project</li>
            </ol>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p>Made with care for people with time blindness</p>
      <p class="version">Version 1.0.0</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
